<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Log</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <h1>Attendance Log</h1>
    <table id="attendanceTable">
        <thead>
            <tr>
                <th>Cardholder</th>
                <th>Entry Time</th>
                <th>Exit Time</th>
                <th>Hours Worked (Total)</th>
            </tr>
        </thead>
        <tbody>
            {% for cardholder, data in grouped_logs.items() %}
            <tr>
                <td>{{ cardholder }}</td>
                <td>
                    {% if data.entries %}
                        {{ data.entries[0].strftime('%Y-%m-%d %H:%M:%S') }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    {% if data.exits %}
                        {{ data.exits[-1].strftime('%Y-%m-%d %H:%M:%S') }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>{{ data.total_hours }}</td>
            </tr>
            <tr>
                <td colspan="4">
                    <div class="daily-details">
                        <h4>Daily Entry, Exit Times, and Hours</h4>
                        <table class="daily-hours-table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Entry Time</th>
                                    <th>Exit Time</th>
                                    <th>Daily Hours</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for date, logs in data.daily_hours.items() %}
                                <tr>
                                    <td>{{ date }}</td>
                                    <td>
                                        {% for log in data.logs if log['Type'] == 'entry' and log['Timestamp'].date() == date %}
                                            {{ log.Timestamp.strftime('%Y-%m-%d %H:%M:%S') }}<br>
                                        {% endfor %}
                                    </td>
                                    <td>
                                        {% for log in data.logs if log['Type'] == 'exit' and log['Timestamp'].date() == date %}
                                            {{ log.Timestamp.strftime('%Y-%m-%d %H:%M:%S') }}<br>
                                        {% endfor %}
                                    </td>
                                    <td>{{ logs }}</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
